<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lswd.youpin.dao.lsyp.RecipeMapper">
  <resultMap id="BaseResultMap" type="com.lswd.youpin.model.lsyp.Recipe">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="recipe_name" jdbcType="VARCHAR" property="recipeName" />
    <result column="recipe_id" jdbcType="VARCHAR" property="recipeId" />
    <result column="imageurl" jdbcType="VARCHAR" property="imageurl" />
    <result column="bigimageurl" jdbcType="VARCHAR" property="bigimageurl" />
    <result column="surplus" jdbcType="INTEGER" property="surplus" />
    <result column="canteen_id" jdbcType="VARCHAR" property="canteenId" />
    <result column="cook_type" jdbcType="SMALLINT" property="cookType" />
    <result column="status" jdbcType="SMALLINT" property="status" />
    <result column="guide_price" jdbcType="REAL" property="guidePrice" />
    <result column="market_price" jdbcType="REAL" property="marketPrice" />
    <result column="category_id" jdbcType="INTEGER" property="categoryId" />
    <result column="categoryName" jdbcType="VARCHAR" property="categoryName" />
    <result column="cook_detail" jdbcType="VARCHAR" property="cookDetail" />
    <result column="is_delete" jdbcType="BIT" property="isDelete" />
    <result column="create_user" jdbcType="VARCHAR" property="createUser" />
    <result column="update_user" jdbcType="VARCHAR" property="updateUser" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="safetyone" jdbcType="VARCHAR" property="safetyone" />
    <result column="safetytwo" jdbcType="VARCHAR" property="safetytwo" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, recipe_name, recipe_id,imageurl,bigimageurl,surplus,canteen_id, cook_type, status, guide_price, market_price, category_id, cook_detail,
    is_delete, create_user, update_user, create_time, update_time
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_recipe
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from t_recipe
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.lswd.youpin.model.lsyp.Recipe">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_recipe (id, recipe_name, recipe_id,imageurl,bigimageurl,surplus,canteen_id,
      cook_type, status, guide_price, market_price,
      category_id, cook_detail, is_delete, 
      create_user, update_user, create_time, 
      update_time, safetyone, safetytwo
      )
    values (#{id,jdbcType=INTEGER}, #{recipeName,jdbcType=VARCHAR}, #{canteenId,jdbcType=VARCHAR},
      #{recipeId,jdbcType=VARCHAR}, #{imageurl,jdbcType=VARCHAR},#{bigimageurl,jdbcType=VARCHAR},#{surplus,jdbcType=INTEGER},
      #{cookType,jdbcType=SMALLINT}, #{status,jdbcType=SMALLINT}, #{guidePrice,jdbcType=REAL},#{marketPrice,jdbcType=REAL},
      #{categoryId,jdbcType=INTEGER}, #{cookDetail,jdbcType=VARCHAR}, #{isDelete,jdbcType=BIT}, 
      #{createUser,jdbcType=VARCHAR}, #{updateUser,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, 
      #{updateTime,jdbcType=TIMESTAMP}, #{safetyone,jdbcType=VARCHAR}, #{safetytwo,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.lswd.youpin.model.lsyp.Recipe">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_recipe
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="recipeName != null">
        recipe_name,
      </if>
      <if test="recipeId != null">
        recipe_id,
      </if>
      <if test="canteenId != null">
        canteen_id,
      </if>
      <if test="imageurl != null">
        imageurl,
      </if>
      <if test="bigimageurl != null">
        bigimageurl,
      </if>
      <if test="surplus != null">
        surplus,
      </if>
      <if test="cookType != null">
        cook_type,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="guidePrice != null">
        guide_price,
      </if>
      <if test="marketPrice != null">
        market_price,
      </if>
      <if test="categoryId != null">
        category_id,
      </if>
      <if test="cookDetail != null">
        cook_detail,
      </if>
      <if test="isDelete != null">
        is_delete,
      </if>
      <if test="createUser != null">
        create_user,
      </if>
      <if test="updateUser != null">
        update_user,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="updateTime != null">
        update_time,
      </if>
      <if test="safetyone != null">
        safetyone,
      </if>
      <if test="safetytwo != null">
        safetytwo,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="recipeName != null">
        #{recipeName,jdbcType=VARCHAR},
      </if>
      <if test="recipeId != null">
        #{recipeId,jdbcType=VARCHAR},
      </if>
      <if test="canteenId != null">
        #{canteenId,jdbcType=VARCHAR},
      </if>
      <if test="imageurl != null">
        #{imageurl,jdbcType=VARCHAR},
      </if>
      <if test="bigimageurl != null">
        #{bigimageurl,jdbcType=VARCHAR},
      </if>
      <if test="surplus != null">
        #{surplus,jdbcType=INTEGER},
      </if>
      <if test="cookType != null">
        #{cookType,jdbcType=SMALLINT},
      </if>
      <if test="status != null">
        #{status,jdbcType=SMALLINT},
      </if>
      <if test="guidePrice != null">
        #{guidePrice,jdbcType=REAL},
      </if>
      <if test="categoryId != null">
        #{categoryId,jdbcType=INTEGER},
      </if>
      <if test="cookDetail != null">
        #{cookDetail,jdbcType=VARCHAR},
      </if>
      <if test="isDelete != null">
        #{isDelete,jdbcType=BIT},
      </if>
      <if test="createUser != null">
        #{createUser,jdbcType=VARCHAR},
      </if>
      <if test="updateUser != null">
        #{updateUser,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="safetyone != null">
        #{safetyone,jdbcType=VARCHAR},
      </if>
      <if test="safetytwo != null">
        #{safetytwo,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.lswd.youpin.model.lsyp.Recipe">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_recipe
    <set>
      <if test="recipeName != null">
      recipe_name = #{recipeName,jdbcType=VARCHAR},
      </if>
      <if test="recipeId != null">
        recipeId = #{recipeId,jdbcType=VARCHAR},
      </if>
      <if test="canteenId != null">
        recipeId = #{canteenId,jdbcType=VARCHAR},
      </if>
      <if test="imageurl != null">
        imageurl = #{imageurl,jdbcType=VARCHAR},
      </if>
      <if test="bigimageurl != null">
        bigimageurl = #{bigimageurl,jdbcType=VARCHAR},
      </if>
      <if test="surplus != null">
        surplus = #{surplus,jdbcType=INTEGER},
      </if>
      <if test="cookType != null">
        cook_type = #{cookType,jdbcType=SMALLINT},
      </if>
      <if test="status != null">
        status = #{status,jdbcType=SMALLINT},
      </if>
      <if test="guidePrice != null">
        guide_price = #{guidePrice,jdbcType=REAL},
      </if>
      <if test="marketPrice != null">
        market_price = #{marketPrice,jdbcType=REAL},
      </if>
      <if test="categoryId != null">
        category_id = #{categoryId,jdbcType=INTEGER},
      </if>
      <if test="cookDetail != null">
        cook_detail = #{cookDetail,jdbcType=VARCHAR},
      </if>
      <if test="isDelete != null">
        is_delete = #{isDelete,jdbcType=BIT},
      </if>
      <if test="createUser != null">
        create_user = #{createUser,jdbcType=VARCHAR},
      </if>
      <if test="updateUser != null">
        update_user = #{updateUser,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        update_time = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="safetyone != null">
        safetyone = #{safetyone,jdbcType=VARCHAR},
      </if>
      <if test="safetytwo != null">
        safetytwo = #{safetytwo,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.lswd.youpin.model.lsyp.Recipe">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_recipe
    set recipe_name = #{recipeName,jdbcType=VARCHAR},
      recipe_id = #{recipeId,jdbcType=VARCHAR},
      canteen_id = #{canteenId,jdbcType=VARCHAR},
      imageurl = #{imageurl,jdbcType=VARCHAR},
      bigimageurl = #{bigimageurl,jdbcType=VARCHAR},
      surplus = #{surplus,jdbcType=INTEGER},
      cook_type = #{cookType,jdbcType=SMALLINT},
      status = #{status,jdbcType=SMALLINT},
      guide_price = #{guidePrice,jdbcType=REAL},
      market_price = #{marketPrice,jdbcType=REAL},
      category_id = #{categoryId,jdbcType=INTEGER},
      cook_detail = #{cookDetail,jdbcType=VARCHAR},
      is_delete = #{isDelete,jdbcType=BIT},
      create_user = #{createUser,jdbcType=VARCHAR},
      update_user = #{updateUser,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      update_time = #{updateTime,jdbcType=TIMESTAMP},
      safetyone = #{safetyone,jdbcType=VARCHAR},
      safetytwo = #{safetytwo,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>

  <!--zhenguanqi write-->
  <insert id="insertRecipe" parameterType="com.lswd.youpin.model.lsyp.Recipe">
    insert into t_recipe (recipe_name,recipe_id,canteen_id,imageurl,bigimageurl,surplus,
    cook_type, status, guide_price,market_price,
    category_id, cook_detail, is_delete,
    create_user, update_user, create_time,update_time)
    values (#{recipeName,jdbcType=VARCHAR},#{recipeId,jdbcType=VARCHAR},#{canteenId,jdbcType=VARCHAR},#{imageurl,jdbcType=VARCHAR},#{bigimageurl,jdbcType=VARCHAR},#{surplus,jdbcType=INTEGER},
    #{cookType,jdbcType=SMALLINT}, #{status,jdbcType=SMALLINT}, #{guidePrice,jdbcType=REAL},#{marketPrice,jdbcType=REAL}, #{categoryId,jdbcType=INTEGER}, #{cookDetail,jdbcType=VARCHAR}, #{isDelete,jdbcType=BIT},
    #{createUser,jdbcType=VARCHAR}, #{updateUser,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP},#{updateTime,jdbcType=TIMESTAMP})
  </insert>

  <delete id="deleteRecipe" parameterType="java.lang.Integer">
    delete from t_recipe  where id = #{id,jdbcType=INTEGER}
  </delete>

  <update id="updateRecipe" parameterType="com.lswd.youpin.model.lsyp.Recipe">
    update t_recipe
    set recipe_name = #{recipeName,jdbcType=VARCHAR},
      recipe_id = #{recipeId,jdbcType=VARCHAR},
      canteen_id = #{canteenId,jdbcType=VARCHAR},
      imageurl = #{imageurl,jdbcType=VARCHAR},
      bigimageurl = #{bigimageurl,jdbcType=VARCHAR},
      surplus = #{surplus,jdbcType=INTEGER},
      cook_type = #{cookType,jdbcType=SMALLINT},
      status = #{status,jdbcType=SMALLINT},
      guide_price = #{guidePrice,jdbcType=REAL},
      market_price = #{marketPrice,jdbcType=REAL},
      category_id = #{categoryId,jdbcType=INTEGER},
      cook_detail = #{cookDetail,jdbcType=VARCHAR},
      is_delete = #{isDelete,jdbcType=BIT},
      create_user = #{createUser,jdbcType=VARCHAR},
      update_user = #{updateUser,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      update_time = #{updateTime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=INTEGER}
  </update>

  <update id="updateRecipeIsDelete" parameterType="java.lang.Integer">
    update t_recipe  set  is_delete = 1,status = 1 where id = #{id,jdbcType=INTEGER}
  </update>

  <select id="getRecipeByRecipeId"  resultMap="BaseResultMap" parameterType="java.lang.String">
    select <include refid="Base_Column_List" />  from t_recipe where  recipe_id =  #{recipeId}
  </select>

  <resultMap id="getRecipeListMap" type="com.lswd.youpin.model.lsyp.Recipe">
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="recipe_name" jdbcType="VARCHAR" property="recipeName" />
    <result column="recipe_id" jdbcType="VARCHAR" property="recipeId" />
    <result column="imageurl" jdbcType="VARCHAR" property="imageurl" />
    <result column="bigimageurl" jdbcType="VARCHAR" property="bigimageurl" />
    <result column="surplus" jdbcType="INTEGER" property="surplus" />
    <result column="canteen_id" jdbcType="VARCHAR" property="canteenId" />
    <result column="cook_type" jdbcType="SMALLINT" property="cookType" />
    <result column="status" jdbcType="SMALLINT" property="status" />
    <result column="guide_price" jdbcType="REAL" property="guidePrice" />
    <result column="market_price" jdbcType="REAL" property="marketPrice" />
    <result column="category_id" jdbcType="INTEGER" property="categoryId" />
    <result column="cook_detail" jdbcType="VARCHAR" property="cookDetail" />
    <result column="create_user" jdbcType="VARCHAR" property="createUser" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
  </resultMap>

  <select id="getRecipeCount" resultType="java.lang.Integer">
    select   COUNT(1)  from t_recipe recipe LEFT JOIN t_recipe_category cate ON recipe.category_id = cate.id
    where 1=1 AND recipe.is_delete = 0
    <if test="keyword != '' ">
      AND  recipe.recipe_name LIKE  #{keyword}
    </if>
    <if test="canteenId != '' ">
      AND  recipe.canteen_id =  #{canteenId}
    </if>
    <if test="canteenId == '' ">
      AND
      <foreach collection="canteenIds" item="can"  separator="OR" open="(" close=")">
        canteen_id=#{can,jdbcType=VARCHAR}
      </foreach>
    </if>
    <if test="categoryId != null ">
      AND  recipe.category_id =  #{categoryId}
    </if>
  </select>

  <select id="getRecipeList"  resultMap="getRecipeListMap">
    select recipe.*,cate.name AS categoryName  from t_recipe recipe LEFT JOIN t_recipe_category cate ON recipe.category_id = cate.id
    WHERE 1=1 AND recipe.is_delete = 0 AND recipe.status = 0
    <if test="keyword != '' ">
      AND recipe.recipe_name  LIKE  concat('%',#{keyword},'%')
    </if>
    <if test="canteenId != '' ">
      AND recipe.canteen_id =  #{canteenId}
    </if>
    <if test="canteenId == '' ">
      AND
      <foreach collection="canteenIds" item="can"  separator="OR" open="(" close=")">
        canteen_id=#{can,jdbcType=VARCHAR}
      </foreach>
    </if>
    <if test="categoryId != null ">
      AND recipe.category_id =  #{categoryId}
    </if>
    limit #{offSet},#{pageSize}
  </select>

  <select id="getRecipeListAllPageCount" resultType="java.lang.Integer">
    select   COUNT(1)  from t_recipe recipe LEFT JOIN t_recipe_category cate ON recipe.category_id = cate.id
    where 1=1 AND recipe.is_delete = 0
    <if test="keyword != ''and keyword!=null ">
      AND  recipe.recipe_name LIKE  concat('%',#{keyword},'%')
    </if>
    <if test="canteenId != ''and canteenId!=null ">
      AND  recipe.canteen_id =  #{canteenId}
    </if>
    <if test="categoryId != null and categoryId!=''">
      AND  recipe.category_id =  #{categoryId}
    </if>
  </select>

  <select id="getRecipeListAllPage"  resultMap="BaseResultMap">
    select recipe.*,cate.name AS categoryName  from t_recipe recipe LEFT JOIN t_recipe_category cate ON recipe.category_id = cate.id
    WHERE 1=1 AND recipe.is_delete = 0 AND recipe.status = 0
    <if test="keyword != ''and  keyword!=null">
      AND  recipe.recipe_name LIKE  concat('%',#{keyword},'%')
    </if>
    <if test="canteenId != ''and canteenId!=null ">
      AND recipe.canteen_id =  #{canteenId}
    </if>
    <if test="categoryId != null and categoryId!='' ">
      AND recipe.category_id =  #{categoryId}
    </if>
    limit #{offSet},#{pageSize}
  </select>


  <!--查询所有的菜品信息，导出用！-->
  <select id="getRecipeListAll"  resultMap="BaseResultMap">
    select <include refid="Base_Column_List" /> from t_recipe WHERE is_delete = 0 AND status = 0
    AND canteen_id in
    <foreach collection="canteenIds" item="canteen" open="(" close=")" separator="," index="index">
      #{canteen}
    </foreach>
  </select>

  <select id="getRecipeListAllAll"  resultMap="BaseResultMap">
    select <include refid="Base_Column_List" /> from t_recipe WHERE is_delete = 0 AND status = 0 AND canteen_id = #{canteenId}
  </select>

  <select id="getRecipeByCategoryId"  resultMap="BaseResultMap">
    select <include refid="Base_Column_List" /> from t_recipe WHERE is_delete = 0 AND status = 0 AND category_id = #{categoryId}
  </select>

  <select id="getRecipeMaxID" resultType="java.lang.Integer">
    select  MAX(id) from t_recipe
  </select>

  <!--菜品计划新增时用到的两个方法，查询list和count-->
  <select id="getRecipeMINICount" resultType="java.lang.Integer">
    select   COUNT(1)  from t_recipe recipe where 1=1 AND recipe.is_delete = 0
    <if test="keyword != '' ">
      AND  recipe.recipe_name LIKE  #{keyword}
    </if>
    <if test="canteenId != '' ">
      AND  recipe.canteen_id =  #{canteenId}
    </if>
    <if test="categoryId != null ">
      AND  recipe.category_id =  #{categoryId}
    </if>
  </select>

  <select id="getRecipeMINI"  resultMap="BaseResultMap">
    select recipe.id,recipe.recipe_id,recipe.recipe_name,recipe.surplus,recipe.guide_price,recipe.market_price from t_recipe recipe
    WHERE 1=1 AND recipe.is_delete = 0 AND recipe.status = 0
    <if test="keyword != '' ">
      AND  recipe.recipe_name LIKE  #{keyword}
    </if>
    <if test="canteenId != '' ">
      AND  recipe.canteen_id =  #{canteenId}
    </if>
    <if test="categoryId != null ">
      AND  recipe.category_id =  #{categoryId}
    </if>
    limit #{offSet},#{pageSize}
  </select>

  <update id="updateRecipeSurPlus">
    update t_recipe set surplus = #{surplus,jdbcType=INTEGER} where recipe_id = #{recipeId,jdbcType=INTEGER}
  </update>


  <!--app+++++++++++++++++++++++-->
  <select id="getRecipeUrlByRecipeId"  resultType="java.util.HashMap" >
    select id,recipe_name as name,bigimageurl as img from t_recipe where  id =  #{id}
  </select>

</mapper>